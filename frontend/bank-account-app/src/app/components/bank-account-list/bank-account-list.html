<div class="container">
  <h2>Bank Accounts</h2>
  <a routerLink="/accounts/new" class="btn btn-primary mb-3">Create New Account</a>

  <div *ngIf="loading" class="loading-indicator">
    <p>Loading accounts...</p>
  </div>

  <div *ngIf="error" class="error-message">
    <p>{{ error }}</p>
    <button class="btn btn-secondary" (click)="loadAccounts()">Try Again</button>
  </div>

  <!-- Use the async pipe to subscribe to the accounts$ observable -->
  <ng-container *ngIf="accounts$ | async as accounts">
    <div *ngIf="!loading && !error && accounts.length === 0" class="no-accounts">
      <p>No bank accounts found. Create one to get started!</p>
    </div>

    <div *ngIf="!loading && !error && accounts.length > 0" class="account-list">
      <div class="account-card" *ngFor="let account of accounts">
        <div class="card-body">
          <h5 class="card-title">{{ account.accountHolderName }}</h5>
          <p class="card-text">Account Number: {{ account.accountNumber }}</p>
          <p class="card-text">Balance: {{ formatCurrency(account.balance) }}</p>
          <div class="actions">
            <a [routerLink]="['/accounts/edit', account.id]" class="btn btn-sm btn-warning" (click)="onEditClick(account.id!)" *ngIf="account.id">Edit</a>
            <button (click)="deleteAccount(account.id!)" class="btn btn-sm btn-danger" *ngIf="account.id">Delete</button>
          </div>
        </div>
      </div>
    </div>
  </ng-container>
</div>
